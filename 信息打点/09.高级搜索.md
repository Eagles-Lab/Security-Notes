# 09.高级搜索

## 1.高级搜索语法

### 1.1 百度搜索
- **site:** 
  限定搜索某个站点或域名 
  例：`site:edu.cn 网络安全`
- **intitle:** 
  搜索标题中包含指定关键词 
  例：`intitle:登录`
- **inurl:** 
  搜索网址中包含指定关键词 
  例：`inurl:admin`
- **filetype:** 
  搜索指定文件类型 
  例：`filetype:pdf 网络安全`
- **双引号 " "** 
  精确匹配搜索内容 
  例：`"网络安全培训"`

---

### 1.2 Google 搜索
- **site:** 
  限定某个网站/域名 
  例：`site:github.com sqlmap`
- **intitle:** 
  页面标题包含关键词 
  例：`intitle:"index of"`
- **inurl:** 
  URL 中包含关键词 
  例：`inurl:login`
- **filetype:** 
  搜索特定文件类型 
  例：`filetype:docx password`
- **双引号 " "** 
  精确匹配 
  例：`"admin panel"`
- **OR / AND** 
  逻辑运算符 
  例：`php OR asp`
- **减号 -** 
  排除某些关键词 
  例：`网络安全 -招聘`

### 1.3 Google搜索语法示例

整理了下一些常见的一些`Google检索的语法`，如下：

```
注入漏洞:
site:edu.cn inurl:id|aspx|jsp|php|asp

文件上传：
site:edu.cn inurl:file|load|editor|Files

前台登录：
site:edu.cn intext:管理|后台|登陆|用户名|密码|验证码|系统|帐号|手册|admin|login|sys|managetem|password|username

site:edu.cn inurl:login|admin|manage|manager|admin_login|login_admin|system|boss|master

敏感信息搜索:
site:edu.cn ( "默认密码" OR "学号" OR "工号")

后台接口和敏感信息探测:
site:edu.cn (inurl:login OR inurl:admin OR inurl:index OR inurl:登录) OR (inurl:config | inurl:env | inurl:setting | inurl:backup | inurl:admin | inurl:php)

查找暴露的特殊文件:
site:edu.cn filetype:txt OR filetype:xls OR filetype:xlsx OR filetype:doc OR filetype:docx OR filetype:pdf

常见的敏感文件扩展:
site:edu.cn ext:log | ext:txt | ext:conf | ext:cnf | ext:ini | ext:env | ext:sh | ext:bak | ext:backup | ext:swp | ext:old | ext:~ | ext:git | ext:svn | ext:htpasswd | ext:htaccess

XSS 漏洞倾向参数:
inurl:q= | inurl:s= | inurl:search= | inurl:query= | inurl:keyword= | inurl:lang= inurl:& site:edu.cn

重定向漏洞倾向参数:
inurl:url= | inurl:return= | inurl:next= | inurl:redirect= | inurl:redir= | inurl:ret= | inurl:r2= | inurl:page= inurl:& inurl:http site:edu.cn

SQL 注入倾向参数:
inurl:id= | inurl:pid= | inurl:category= | inurl:cat= | inurl:action= | inurl:sid= | inurl:dir= inurl:& site:edu.cn

SSRF 漏洞倾向参数:
inurl:http | inurl:url= | inurl:path= | inurl:dest= | inurl:html= | inurl:data= | inurl:domain= | inurl:page= inurl:& site:edu.cn

本地文件包含（LFI）倾向参数:
inurl:include | inurl:dir | inurl:detail= | inurl:file= | inurl:folder= | inurl:inc= | inurl:locate= | inurl:doc= | inurl:conf= inurl:& site:edu.cn

远程命令执行（RCE）倾向参数:
inurl:cmd | inurl:exec= | inurl:query= | inurl:code= | inurl:do= | inurl:run= | inurl:read= | inurl:ping= inurl:& site:edu.cn

敏感参数:
inurl:email= | inurl:phone= | inurl:password= | inurl:secret= inurl:& site:edu.cn

API 文档:
inurl:apidocs | inurl:api-docs | inurl:swagger | inurl:api-explorer site:edu.cn

代码泄露:
site:pastebin.com edu.cn

云存储:
site:s3.amazonaws.com edu.cn

JFrog Artifactory:
site:jfrog.io edu.cn

Firebase:
site:firebaseio.com edu.cn

文件上传端点:
site:edu.cn "choose file"

漏洞赏金和漏洞披露程序:
"submit vulnerability report" | "powered by bugcrowd" | "powered by hackerone" site:*/security.txt "bounty"

暴露的 Apache 服务器状态:
site:*/server-status apache

WordPress:
inurl:/wp-admin/admin-ajax.php
```

### 1.4 在线工具

https://app.pentest-tools.com/information-gathering/google-hacking#

![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUpEJvwgTTydKw53iboicaDuV3TKjG6drWxBSAxbn76c7ENRvhP2lxY9iaud4rWqLQfqVcbby5GibtF8g/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=10)

![image-20251021124613946](./09.高级搜索/image-20251021124613946.png)

## 2.高级搜索引擎

### 2.1 FOFA

#### 2.1.1 什么是FOFA？

FOFA是一款网络空间测绘的搜索引擎，旨在帮助用户以搜索的方式查找**公网上的互联网资产**。简单的来说就是**网络安全中的”谷歌”**，不同的是，这些数据不仅包括像谷歌一样的网页，还包括像摄像头、打印机、数据库、操作系统等资产。

网络空间测绘可以被认为是网络空间的“地图”。就像谷歌地图或高德地图通过卫星图像对地形进行测绘，网络空间测绘也是通过技术探针对全球网络资产进行探测。但fofa是基于IP和端口去发现资产，因此有些资产是发现不了的，类似于**二级目录下的网页大概率会被收录不了**。

#### 2.1.2 fofa基础语法

基础语法在FOFA官网(https://fofa.info/)处，这里全部贴过来做个保留，可以直接跳过这个部分，等到用到的时候再查阅。

![image-20250910145047856](./09.高级搜索/image-20250910145047856.png)

![image-20250910145109346](./09.高级搜索/image-20250910145109346.png)

高级搜索

| 逻辑连接符 | 具体含义                                                     |
| ---------- | ------------------------------------------------------------ |
| =          | 匹配，当设置为`=""`时，可查询不存在字段或者值为空的情况。    |
| ==         | 完全匹配，当设置为`==""`时，可查询存在且值为空的情况。       |
| &&         | 与                                                           |
| ll         | 或                                                           |
| !=         | 不匹配，当设置为`!=""`时，可查询值为空的情况。               |
| *=         | 模糊匹配，使用`*`或者`?`进行搜索，比如`banner*="mys??"`(个人版及以上可用)。 |
| ()         | 确认查询优先级，括号内容优先级最高。                         |

基础类(General)

| 语法         | 例句                                                     | 描述                                                |
| ------------ | -------------------------------------------------------- | --------------------------------------------------- |
| IP           | ip=`"`1.1.1.1`"` ip=`"`220.181.111.1/24`"` ip=`"`IPv6`"` | 分别通过单一IPv4地址、IPv4C段、单一IPv6地址进行查询 |
| 端口         | port=`"`6379`"`                                          | 通过端口号进行查询                                  |
| 域名         | domain=`"`qq.com`"`                                      | 通过根域名进行查询                                  |
| 主机         | host=`"`.fofa.info`"`                                    | 通过主机名进行查询                                  |
| 操作系统     | os=`"`centos`"`                                          | 通过操作系统进行查询                                |
| 服务器       | server=`"`Microsoft-IIS/10`"`                            | 通过服务器进行查询                                  |
| 自治系统号   | asn=`"`19551`"`                                          | 通过自治系统号进行搜索                              |
| 组织         | org=`"`LLCBaxet`"`                                       | 通过所属组织进行查询                                |
| 是否拥有域名 | is_domain=true is_domain=false                           | 筛选拥有域名的资产/筛选没有域名的资产               |
| 是否为IPv6   | is_ipv6=true is_ipv6=false                               | 筛选是IPv6的资产/筛选是IPv4的资产                   |

标记类(SpecialLabel)

| 语法        | 例句                                    | 用途说明                                            |
| ----------- | --------------------------------------- | --------------------------------------------------- |
| app         | app=`"`Microsoft-Exchange`"`            | 通过FOFA整理的规则进行查询                          |
| fid         | fid=`"`sSXXGNUO2FefBTcCLIT/2Q==`"`      | 通过FOFA聚合的站点指纹进行查询                      |
| product     | product=`"`NGINX`"`                     | 通过FOFA标记的产品名进行查询                        |
| category    | category=`"`服务`"`                     | 通过FOFA标记的分类进行查询                          |
| type        | type=`"`service`"` type=`"`subdomain`"` | 筛选协议资产 筛选服务（网站类）资产                 |
| cloud_name  | cloud_name=`"`Aliyundun`"`              | 通过云服务商进行查询                                |
| is_cloud    | is_cloud=true is_cloud=false            | 筛选是云服务的资产 筛选不是云服务的资产             |
| is_fraud    | is_fraud=true is_fraud=false            | 筛选是仿冒垃圾站群的资产 筛选不是仿冒垃圾站群的资产 |
| is_honeypot | is_honeypot=true is_honeypot=false      | 筛选是蜜罐的资产 筛选不是蜜罐的资产                 |

协议类(type=service)

| 语法          | 例句                                            | 用途说明                                            |
| ------------- | ----------------------------------------------- | --------------------------------------------------- |
| protocol      | protocol=`"`quic`"`                             | 通过协议名称进行查询                                |
| banner        | banner=`"`users`"`                              | 通过协议返回信息进行查询                            |
| base_protocol | base_protocol=`"`udp`"` base_protocol=`"`tcp`"` | 查询传输层为udp协议的资产 查询传输层为tcp协议的资产 |

网站类(type=subdomain)

| 语法         | 例句                                             | 用途说明                                     |
| ------------ | ------------------------------------------------ | -------------------------------------------- |
| title        | title=`"`beijing`"`                              | 通过网站标题进行查询                         |
| header       | header=`"`elastic`"`                             | 通过响应标头进行查询                         |
| header_hash  | header_hash=`"`1258854265`"`                     | 通过http/https响应头计算的hash值进行查询     |
| body         | body=`"`网络空间测绘`"`                          | 通过HTML正文进行查询                         |
| body_hash    | body_hash=`"`-2090962452`"`                      | 通过HTML正文计算的hash值进行查询             |
| js_name      | js_name=`"`js/jquery.js`"`                       | 通过HTML正文包含的JS进行查询                 |
| js_md5       | js_md5=`"`82ac3f14327a8b7ba49baa208d4eaa15`"`    | 通过JS源码进行查询                           |
| cname        | cname=`"`ap21.inst.siteforce.com`"`              | 通过别名记录进行查询                         |
| cname_domain | cname_domain=`"`siteforce.com`"`                 | 通过别名记录解析的主域名进行查询             |
| icon_hash    | icon_hash=`"`-247388890`"`                       | 通过网站图标的hash值进行查询                 |
| status_code  | status_code=`"`402`"`                            | 筛选服务状态为402的服务（网站）资产          |
| icp          | icp=`"`京ICP证030173号`"`                        | 通过HTML正文包含的ICP备案号进行查询          |
| sdk_hash     | sdk_hash==`"`Mkb4Ms4R96glv/T6TRzwPWh3UDatBqeF`"` | 通过网站嵌入的第三方代码计算的hash值进行查询 |

地理位置(Location)

| 语法    | 例句                                    | 用途说明                                  |
| ------- | --------------------------------------- | ----------------------------------------- |
| country | country=`"`CN`"` country=`"`中国`"`     | 通过国家的简称代码或中文名称进行查询      |
| region  | region=`"`Zhejiang`"` region=`"`浙江`"` | 通过省份/地区的英文名称或中文名称进行查询 |
| city    | city=`"`Hangzhou`"`                     | 通过城市英文名称进行查询                  |

证书类

| 语法             | 例句                                            | 用途说明                         |
| ---------------- | ----------------------------------------------- | -------------------------------- |
| cert             | cert=`"`baidu`"`                                | 通过证书进行查询                 |
| cert.subject     | cert.subject=`"`OracleCorporation`"`            | 通过证书的持有者进行查询         |
| cert.issuer      | cert.issuer=`"`DigiCert`"`                      | 通过证书的颁发者进行查询         |
| cert.subject.org | cert.subject.org=`"`OracleCorporation`"`        | 通过证书持有者的组织进行查询     |
| cert.subject.cn  | cert.subject.cn=`"`baidu.com`"`                 | 通过证书持有者的通用名称进行查询 |
| cert.issuer.org  | cert.issuer.org=`"`cPanel,Inc.`"`               | 通过证书颁发者的组织进行查询     |
| cert.issuer.cn   | cert.issuer.cn=`"`SynologyInc.CA`"`             | 通过证书颁发者的通用名称进行查询 |
| cert.is_valid    | cert.is_valid=true cert.is_valid=false          | 筛选证书有效性的资产             |
| cert.is_match    | cert.is_match=true cert.is_match=false          | 筛选证书和域名匹配性的资产       |
| cert.is_expired  | cert.is_expired=true cert.is_expired=false      | 筛选证书过期状态的资产           |
| jarm             | jarm=`"`15af977ce25de452b96affa2addb1036`"`     | 通过JARM指纹进行查询             |
| tls.version      | tls.version=`"`TLS1.3`"`                        | 通过tls的协议版本进行查询        |
| tls.ja3s         | tls.ja3s=`"`15af977ce25de452b96affa2addb1036`"` | 通过tls的ja3s指纹进行查询        |

时间类(Lastupdatetime)

| 语法         | 例句                                            | 用途说明                     |
| ------------ | ----------------------------------------------- | ---------------------------- |
| after        | after=`"`2023-01-01`"`                          | 筛选某一时间之后有更新的资产 |
| before       | before=`"`2023-12-01`"`                         | 筛选某一时间之前有更新的资产 |
| after&before | after=`"`2023-01-01`"`&&before=`"`2023-12-01`"` | 筛选某一时间区间有更新的资产 |

独立IP语法

独立IP系列语法，不可和上面其他语法共用

| 语法         | 例句                       | 用途说明                            |
| ------------ | -------------------------- | ----------------------------------- |
| port_size    | port_size=`"`6`"`          | 筛选开放端口数量等于6个的独立IP     |
| port_size_gt | port_size_gt=`"`6`"`       | 筛选开放端口数量大于6个的独立IP     |
| port_size_lt | port_size_lt=`"`12`"`      | 筛选开放端口数量小于12个的独立IP    |
| ip_ports     | ip_ports=`"`80,161`"`      | 筛选同时开放不同端口的独立IP        |
| ip_country   | ip_country=`"`CN`"`        | 通过国家的简称代码进行查询独立IP    |
| ip_region    | ip_region=`"`Zhejiang`"`   | 通过省份/地区英文名称进行查询独立IP |
| ip_city      | ip_city=`"`Hangzhou`"`     | 通过城市英文名称进行查询独立IP      |
| ip_after     | ip_after=`"`2021-03-18`"`  | 筛选某一时间之后有更新的独立IP      |
| ip_before    | ip_before=`"`2019-09-09`"` | 筛选某一时间之前有更新的独立IP      |

#### 2.1.3 fofa的奇淫巧技

##### 1.批量发现资产

在平时的漏洞挖掘中，若发现漏洞，都可以尝试通过FOFA搜索，因为这个模板很有可能是一些通用的建站模板，通过F12查看网页特征，直接FOFA搜索网页特征`body="为全体师生提供咨询、生活....综合服务"`，这个地方要根据实际的情况选择语法进行搜索，比如搜索特别的js名称，`favicon.ico`等，可使用fofa批量发现相关资产

##### 2.发现脆弱资产

挖掘特定目标的漏洞，可通过fofa目标网站的`favicon`图标，例如:`icon_hash="1471194169"`，可检索到大量隐藏资产。

##### 3.其他操作

除了上述这些操作，还可以利用fofa：

- 找DVWA靶场：`title="DVWA"`
- SQLi-LABS靶场:`title="SQL Injections"`
- 看看黑客们都用啥工具：`body="Directory listing for /" && body="dirsearch"`,这里工具可以替换为BurpSuite等
- 阿里云key：`body="AccessKeyId" && body="AccessKeySecret" && body="Expiration"`

### 2.2 hunter

#### 2.2.1 Hunter简介
- **产品定位**：奇安信推出的"攻击面搜索"引擎，聚焦**可被利用的互联网资产**。网址：https://hunter.qianxin.com/
- **数据来源**：流量探针、证书日志、DNS、GitHub/网盘泄漏、FOFA合作节点，日更十亿条。
- **核心差异**：自带「漏洞验证+弱口令+钓鱼」标签，红队快速找入口，蓝队做暴露面收敛。
- **账号体系**：
  - 免费版 50 积分/日
  - 教育版 200 积分/日（教师邮箱+教务证明）
  - 政企版不限积分，含API、订阅告警

#### 2.2.2 Hunter基础语法
| 字段       | 示例                  | 说明         |
| ---------- | --------------------- | ------------ |
| ip         | `ip="202.119.1.0/24"` | 单IP或C段    |
| domain     | `domain="*.edu.cn"`   | 子域通配     |
| cert       | `cert="tsinghua"`     | 证书关键字   |
| title      | `title="后台登录"`    | 页面标题     |
| header     | `header="thinkphp"`   | 响应头       |
| body       | `body="password"`     | HTML正文     |
| is_vul     | `is_vul="T"`          | 已验证漏洞   |
| is_weak    | `is_weak="T"`         | 检测到弱口令 |
| is_fishing | `is_fishing="T"`      | 钓鱼/仿冒    |
| after      | `after="2024-01-01"`  | 新增资产     |
| before     | `before="2023-12-31"` | 历史资产     |

**逻辑运算**：`&&` 与，`||` 或，`!` 非，`()` 优先级  
**大小写**：默认不区分，用 `"*"` 强制通配

#### 2.2.3 Hunter热门语法
| 语法                                      | 含义        |
| ------------------------------------------------- | --------------------------------------------- |
| ip.tag="CDN"                                      | 查询包含IP标签"CDN"的资产 (查看枚举值)        |
| web.similar="baidu.com:443"                       | 查询与baidu.com:443网站的特征相似的资产       |
| web.similar_icon=="17262739310191283300"          | 查询网站icon与该icon相似的资产                |
| web.similar_id="3322dfb483ea6fd250b29de488969b35" | 查询与该网页相似的资产                        |
| web.tag="登录页面"                                | 查询包含资产标签"登录页面"的资产 (查看枚举值) |
| domain.suffix="qianxin.com"                       | 搜索主域为"qianxin.com"的网站                 |
| web.icon="22eeab765346f14faf564a4709f98548"       | 查询网站icon与该icon相同的资产                |
| ip.port_count>"2"                                 | 搜索开放端口大于2的IP（支持等于、大于、小于） |
| is_web=true                                       | 搜索web资产                                   |
| cert.is_trust=true                                | 搜索证书可信的资产                            |

#### 2.2.4 Hunterd 奇淫巧技

##### 1.**通过网站标题关键词**

检索站点标题可以尝试带有“登录”、“管理”、“后台”、“中心”等关键词，这里我选择的是domain_suffix="baidu.com"&&title="登录"&&title="管理"，图中可以看到有2条匹配资产。

![image-20250912140234161](./09.高级搜索/image-20250912140234161.png)

##### 2. **快速过滤无效资产**

点击IP、域名、网站标题、状态码、ICP备案企业、地理位置，可以快速过滤想看/不想看的数据，例如下图：只看网站标题为`”登录-BOSS管家管家端“`的资产。

![image-20250912143652519](./09.高级搜索/image-20250912143652519.png)