# Kali Linux 基础与常用工具

## 前言：Kali Linux 在网络安全中的定位

Kali Linux 是由 Offensive Security 团队开发的**专业渗透测试与网络安全审计操作系统**，集成了超过 600 款安全工具，覆盖漏洞扫描、渗透攻击、密码破解、流量分析等全流程安全测试需求。它不仅是企业安全团队、白帽黑客的核心工具，也是网络安全专业学生入门 “实战技术” 的首选学习平台。


***

## 1.1 Kali 安全：基础认知与安全规范

### 1.1.1 什么是 Kali Linux？

#### （1）Kali 的起源与定位



* **起源**：Kali Linux 源于 2006 年发布的 BackTrack 系统（早期渗透测试系统），2013 年正式更名为 Kali Linux，至今已更新至 Kali 2025.1 版本，支持 x86、ARM 等多种架构（可安装在电脑、虚拟机、树莓派等设备上）。

* **核心定位**：“专为渗透测试而生”—— 无需手动安装大量工具，开箱即可使用，且工具版本经过官方适配，避免兼容性问题（如 SQLmap、Nmap 等工具均为最新稳定版）。

* **常见应用场景**：


1. 渗透测试实战（模拟攻击者视角，发现并验证系统漏洞）；

2. 网络安全教学与实验（学习工具使用、漏洞原理的标准化环境）。

#### （2）Kali 的安装与基本配置

为方便学习，推荐使用 “虚拟机安装” 方式（无需修改物理机系统，支持快照回滚，适合实验）：



1. **环境准备**：

* 虚拟机软件：VMware Workstation 16+ 或 VirtualBox 7+；

* Kali 镜像：官网下载（[https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines) ，推荐 “VMware 预构建镜像”，无需手动配置）。

1. **关键配置**：

* 默认账号密码：`kali/kali`（首次登录后建议通过 `passwd` 命令修改密码，如 `passwd kali`，输入新密码时无明文显示，输入两次即可）；

* 网络模式：选择 “桥接模式”（可让 Kali 与物理机在同一局域网，方便测试本地靶机）或 “NAT 模式”（仅需访问互联网时使用）；

* 工具更新：登录后执行 `sudo apt update && sudo apt upgrade -y`，更新系统与工具至最新版本（避免旧版本工具存在漏洞或功能缺失）。

### 1.1.2 Kali 的安全：合法使用与风险规避

Kali 是 “双刃剑”—— 正确使用可保护系统安全，滥用则可能触犯法律。作为网络安全专业学生，必须牢记以下安全规范：

#### （1）合法使用的核心原则



1. **“授权测试” 是前提**：

* 仅对 “自己拥有所有权” 或 “获得明确书面授权” 的系统进行测试（如本地搭建的靶机、学校提供的实验环境）；

* 严禁未经授权测试公网网站、企业系统（即使系统存在明显漏洞），否则可能违反《中华人民共和国网络安全法》《刑法》第 285 条（非法侵入计算机信息系统罪）、第 286 条（破坏计算机信息系统罪）。

1. **“记录留痕” 是责任**：

* 测试过程中需完整记录操作步骤、命令输出、漏洞结果（如使用 `script` 命令记录终端操作，`script -a kali_test_202506.log`，结束后按 `Ctrl+D` 保存）；

* 测试完成后，需向授权方提交《渗透测试报告》，明确漏洞位置、危害等级及修复建议，不得泄露测试中获取的敏感数据（如用户密码、数据库信息）。

#### （2）Kali 使用中的安全风险



1. **工具自身风险**：部分工具（如 Metasploit）可能被杀毒软件误报为 “恶意程序”，建议在实验环境中关闭物理机杀毒软件的 “实时防护”（仅针对实验期间，结束后需重新开启）；

2. **网络暴露风险**：Kali 作为渗透测试系统，若直接接入公网，可能被黑客扫描并利用漏洞（如默认账号密码未修改），建议仅在 “隔离实验环境” 中使用（如关闭公网连接，仅连接本地靶机）；

3. **操作失误风险**：部分命令（如 `rm -rf /`）会删除系统核心文件，导致 Kali 崩溃，执行高危命令前需反复确认（推荐使用 `ls` 命令先查看目标路径，再执行删除 / 修改操作）。



***

## 1.2 Kali 常用工具：实战级工具拆解与实操

Kali 内置工具众多，本节聚焦 4 款 “渗透测试高频工具”——SQLmap（SQL 注入测试）、dirsearch（目录扫描）、Nmap（端口扫描）、Burp Suite Scanner（漏洞扫描），从 “功能定位 - 核心命令 - 实战案例” 三方面讲解，确保大家能直接上手使用。

### 1.2.1 SQLmap：自动化 SQL 注入测试工具

#### （1）工具定位

SQLmap 是一款开源的自动化 SQL 注入工具，支持检测并利用 MySQL、Oracle、SQL Server 等主流数据库的 SQL 注入漏洞，可实现 “漏洞探测 - 数据提取 - 权限提升” 全流程自动化，是 Web 渗透中 “检测 SQL 注入漏洞” 的首选工具。

#### （2）核心命令与参数

SQLmap 的命令格式为：`sqlmap [选项] -u "目标URL"`，常用核心参数如下：



| 参数                                | 功能说明                                                                      |
| --------------------------------- | ------------------------------------------------------------------------- |
| `-u "URL"`                        | 指定测试目标 URL（需包含可能存在注入的参数，如 `http://test.com/login?id=1`）                   |
| `--dbs`                           | 枚举数据库名称（获取目标系统所有数据库）                                                      |
| `--current-db`                    | 获取当前使用的数据库名称                                                              |
| `--tables -D "库名"`                | 枚举指定数据库下的所有表名（如 `--tables -D testdb` 枚举 testdb 库的表）                       |
| `--columns -T "表名" -D "库名"`       | 枚举指定表的所有字段（如 `--columns -T users -D testdb` 枚举 users 表的字段）                |
| `--dump -T "表名" -D "库名" -C "字段名"` | 导出指定表的指定字段数据（如 `--dump -T users -D testdb -C "username,password"` 导出账号密码） |
| `--os-shell`                      | 尝试获取操作系统 Shell（需目标数据库权限足够，且支持执行系统命令）                                      |
| `-r 请求文件.txt`                     | 从本地请求文件中读取 HTTP 请求（适合测试 POST 型注入，需先用 Burp 抓包保存为文件）                        |

#### （3）实战案例：测试 GET 型 SQL 注入

假设目标靶机（如 DVWA 漏洞环境）存在 SQL 注入漏洞，URL 为 `http://192.168.1.100/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#`，步骤如下：



1. **漏洞探测**：判断目标 URL 是否存在 SQL 注入漏洞



```
sqlmap -u "http://192.168.1.100/dvwa/vulnerabilities/sqli/?id=1\&Submit=Submit#" --cookie "security=low; PHPSESSID=abc123"
```



* 说明：`--cookie` 参数用于携带登录凭证（DVWA 需登录后才能访问漏洞页面，Cookie 可通过浏览器 F12 查看 “Application → Cookies” 获取）；

* 结果：若 SQLmap 提示 “Parameter 'id' is vulnerable to SQL injection”，证明存在注入漏洞。

1. **枚举数据库**：获取目标所有数据库名称



```
sqlmap -u "http://192.168.1.100/dvwa/vulnerabilities/sqli/?id=1\&Submit=Submit#" --cookie "security=low; PHPSESSID=abc123" --dbs
```



* 结果：通常会返回 `dvwa`（目标应用数据库）、`information_schema`（MySQL 系统数据库）等。

1. **导出敏感数据**：导出 dvwa 库中 users 表的 username 和 password 字段



```
sqlmap -u "http://192.168.1.100/dvwa/vulnerabilities/sqli/?id=1\&Submit=Submit#" --cookie "security=low; PHPSESSID=abc123" --dump -T users -D dvwa -C "username,password"
```



* 结果：SQLmap 会自动解密 MD5 格式的密码（如 `admin` 的密码 `5f4dcc3b5aa765d61d8327deb882cf99` 会被解密为 `password`）。

### 1.2.2 dirsearch：Web 目录与文件扫描工具

#### （1）工具定位

dirsearch 是一款基于 Python 的 Web 目录扫描工具，通过 “字典爆破” 的方式，探测目标 Web 服务器上的隐藏目录（如 `admin`、`backup`）和敏感文件（如 `config.php`、`backup.zip`），帮助渗透测试者发现 “未授权访问的后台”“备份文件泄露” 等漏洞。

#### （2）核心命令与参数

dirsearch 的命令格式为：`dirsearch -u "目标URL" [选项]`，常用参数如下：



| 参数         | 功能说明                                                                                                                         |
| ---------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `-u "URL"` | 指定目标 URL（如 `http://192.168.1.100/dvwa/`）                                                                                     |
| `-e 后缀`    | 指定文件后缀名（如 `-e php,txt,zip` 扫描 PHP、TXT、ZIP 格式文件）                                                                              |
| `-w 字典路径`  | 使用自定义字典（默认字典路径为 `/usr/share/dirsearch/db/dicc.txt`，可替换为更大的字典如 `/usr/share/wordlists/dirbuster/directory-list-2.3-small.txt`） |
| `-t 线程数`   | 设置扫描线程（默认线程为 20，线程数越高扫描越快，但可能被目标 WAF 拦截，建议测试时设为 10-30）                                                                       |
| `-x 状态码`   | 排除指定状态码的结果（如 `-x 404,500` 不显示 404（文件不存在）、500（服务器错误）的结果）                                                                      |
| `-r`       | 递归扫描（扫描到目录后，自动深入该目录继续扫描，如扫描到 `admin/` 后，继续扫描 `admin/login.php`）                                                              |

#### （3）实战案例：扫描 DVWA 靶机目录

目标 URL 为 `http://192.168.1.100/dvwa/`，步骤如下：



1. **基础扫描**：使用默认字典扫描目录与 PHP 文件



```
dirsearch -u "http://192.168.1.100/dvwa/" -e php -t 20
```



* 结果：会扫描出 `login.php`（登录页）、`vulnerabilities/`（漏洞模块目录）、`config/`（配置文件目录）等。

1. **深度扫描**：递归扫描并排除 404 结果



```
dirsearch -u "http://192.168.1.100/dvwa/" -e php,txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -r -x 404
```



* 结果：可能发现敏感文件如 `config/config.inc.php`（数据库配置文件）、`backup/dvwa_backup.zip`（备份文件）。

### 1.2.3 Nmap：网络探测与端口扫描工具

#### （1）工具定位

Nmap（Network Mapper）是一款开源的网络探测工具，核心功能包括 “主机存活探测”“端口扫描”“服务版本识别”“操作系统指纹识别”，是渗透测试 “信息收集阶段” 的核心工具 —— 通过 Nmap 可快速了解目标网络的 “存活主机有哪些”“开放了哪些端口”“运行了什么服务”，为后续漏洞测试提供方向。

#### （2）核心命令与参数

Nmap 的命令格式为：`nmap [选项] 目标IP/网段`，常用参数如下：



| 参数             | 功能说明                                                                               |
| -------------- | ---------------------------------------------------------------------------------- |
| `-sP`          | 主机存活探测（仅判断目标是否在线，不扫描端口，速度快）                                                        |
| `-p 端口范围`      | 指定扫描端口（如 `-p 80,443` 扫描 80 和 443 端口；`-p 1-1000` 扫描 1-1000 端口；`-p-` 扫描所有 65535 个端口） |
| `-sT`          | TCP 全连接扫描（完整的三次握手，准确性高，但易被目标防火墙检测）                                                 |
| `-sS`          | TCP 半连接扫描（仅发送 SYN 包，不完成三次握手，隐蔽性高，推荐使用）                                             |
| `-sV`          | 服务版本识别（探测端口上运行的服务版本，如 `Apache httpd 2.4.49`）                                       |
| `-O`           | 操作系统指纹识别（判断目标主机的操作系统，如 `Linux 3.10 - 4.19`）                                        |
| `-A`           | 全面扫描（包含 `-sV`、`-O`、脚本扫描等，适合深度信息收集，但速度较慢）                                           |
| `-oN 输出文件.txt` | 将扫描结果保存为文本文件（便于后续分析，如 `nmap -A 192.168.1.100 -oN nmap_result.txt`）                 |

#### （3）实战案例：探测 WebLogic 靶机

假设目标 WebLogic 靶机 IP 为 `192.168.1.101`，需了解其开放端口与服务，步骤如下：



1. **快速端口扫描**：扫描 1-10000 端口，识别服务版本



```
nmap -sS -p 1-10000 -sV 192.168.1.101
```



* 结果：通常会显示 `7001/tcp open  http  Oracle WebLogic Server ``10.3.6.0`（WebLogic 管理控制台端口）、`3306/tcp open  mysql  MySQL 5.7.30`（数据库端口）等。

1. **全面信息收集**：操作系统识别 + 服务详细信息



```
nmap -A 192.168.1.101 -p 7001,3306 -oN weblogic\_nmap.txt
```



* 结果：会补充显示操作系统版本（如 `Linux 4.15.0-142-generic`）、WebLogic 的 HTTP 响应头、MySQL 的版本细节等，扫描结果保存至 `weblogic_nmap.txt` 文件。

### 1.2.4 Burp Suite Scanner：Web 漏洞自动化扫描工具

#### （1）工具定位

Burp Suite 是 Kali 内置的 “Web 渗透测试集成平台”，包含 Proxy（代理）、Scanner（漏洞扫描）、Intruder（暴力破解）、Repeater（请求重放）等模块。其中 **Burp Suite Scanner** 是自动化漏洞扫描模块，可检测 SQL 注入、XSS、文件上传、命令注入等常见 Web 漏洞，适合快速发现目标应用的安全隐患。

#### （2）工具启动与基础配置



1. **启动 Burp Suite**：

* 在 Kali 终端执行 `burpsuite` 命令，首次启动会提示 “选择临时项目”，点击 “Next → Start Burp” 即可（免费版功能足够满足基础扫描需求，专业版需破解，学习阶段建议使用免费版）。

1. **配置浏览器代理**：

* Burp Scanner 需通过 “代理” 拦截浏览器请求，因此需将浏览器代理设置为 `127.0.0.1:8080`（Burp 默认代理端口）；

* 以 Chrome 为例：设置 → 高级 → 系统 → 代理设置 → 手动设置代理，地址填 `127.0.0.1`端口填 `8080`，保存后关闭设置。
* 注意：若 Kali 是虚拟机，需在虚拟机内的浏览器配置代理（如 Kali 自带的 Firefox），而非物理机浏览器，避免代理路径错误。

1. **安装 CA 证书（解决 HTTPS 拦截问题）**：

* Burp 默认无法拦截 HTTPS 请求，需安装 Burp 的 CA 证书：

1. 打开 Kali 内的 Firefox，访问 `http://burp`（Burp 内置的证书下载页面）；

2. 点击页面中的 “CA Certificate”，下载证书文件（默认名为 `cacert.der`）；

3. 打开 Firefox 设置 → 隐私与安全 → 证书 → 查看证书 → 导入，选择下载的 `cacert.der`，勾选 “信任由此证书颁发的网站”，完成安装。
#### （3）实战案例：扫描 DVWA 靶机的 Web 漏洞

目标 URL 为 `http://192.168.1.100/dvwa/`，步骤如下：



1. **拦截并发送请求到 Scanner**：


   1. 确保 Burp Proxy 处于 “Intercept is on” 状态（Proxy 标签页下，点击 “Intercept” 按钮，显示绿色即开启）；

   2. 在 Kali 的 Firefox 中访问 `http://192.168.1.100/dvwa/`，输入账号密码登录（DVWA 默认账号 `admin`，密码 `password`）；

   3. Burp 会拦截到登录后的请求，右键点击该请求，选择 “Send to Scanner”，将请求发送到 Scanner 模块。

2. **配置并启动扫描**：


   1. 切换到 Burp 的 “Scanner” 标签页，点击左侧 “New Scan”，打开扫描配置窗口；

   2. 在 “Scan Type” 中选择 “Active Scan”（主动扫描，会向目标发送测试请求，适合漏洞验证）；

   3. 在 “Scan Insertion Points” 中确认目标 URL 正确，点击 “Start Scan” 启动扫描。

3. **查看并分析扫描结果**：


   1. 扫描过程中，可在 “Scanner → Results” 中实时查看漏洞结果；

   2. 扫描完成后，结果会按 “漏洞严重程度” 分类（高危、中危、低危、信息），例如：

* 高危漏洞：SQL 注入（如 `vulnerabilities/sqli/` 页面的 `id` 参数）、命令注入（如 `vulnerabilities/command injection/` 页面）；

* 中危漏洞：XSS 跨站脚本（如 `vulnerabilities/xss_r/` 页面的输入框）；

* 信息泄露：备份文件（如 `dvwa_backup.zip`）、服务器版本信息（如 Apache 版本）。

1. 点击任意漏洞结果，可查看 “Request”（测试请求包）、“Response”（目标响应包）、“Issue Detail”（漏洞详情与修复建议），帮助理解漏洞原理。

